{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/blockchain_project/src/components/Grosir/Batch/DaftarBatch.js\";\nimport { Fragment, Component } from \"react\";\nimport DaftarBatchForm from \"./DaftarBatchForm\";\nimport UserService from \"../../../services/user.service\";\nimport showResults from \"../../showResults/showResults\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class DaftarBatch extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onFileChange = file => {\n      this.setState({\n        imageFile: file\n      });\n    };\n\n    this.onCertificateChange = file => {\n      this.setState({\n        certificateFile: file\n      });\n    };\n\n    this.wait = ms => {\n      var start = new Date().getTime();\n      var end = start;\n\n      while (end < start + ms) {\n        end = new Date().getTime();\n      }\n    };\n\n    this.handleSubmit = values => {\n      const formData = new FormData();\n      const batchID = this.handleIDBatch();\n\n      if (values.batch_id) {\n        formData.append(\"batch_id\", values.batch_id);\n        console.log('masuk value batch id');\n      } else {\n        formData.append(\"batch_id\", batchID);\n        console.log('masuk increment batch id');\n      }\n\n      if (values.biji_id != undefined && values.jenis_id != undefined && // values.biji_id != undefined &&\n      // values.jenis_id != undefined &&\n      values.proses_id != undefined && values.supplier_id != undefined && values.tgl_panen != undefined && values.volume != undefined && //Form Baru\n      values.moisture != undefined && values.videoCulture != undefined && values.storytelling != undefined && this.state.imageFile != \"\" && this.state.certificateFile != \"\") {\n        formData.append(\"biji_id\", values.biji_id);\n        formData.append(\"jenis_id\", values.jenis_id);\n        formData.append(\"proses_id\", values.proses_id);\n        formData.append(\"supplier_id\", values.supplier_id);\n        formData.append(\"tgl_panen\", values.tgl_panen);\n        formData.append(\"volume\", values.volume); //Form Baru\n\n        formData.append(\"moisture\", values.moisture);\n        formData.append(\"video_culture\", values.videoCulture);\n        formData.append(\"storytelling\", values.storytelling);\n\n        for (let i = 0; i < this.state.imageFile.length; i++) {\n          formData.append(\"files[]\", this.state.imageFile[i]);\n        }\n\n        for (let i = 0; i < this.state.certificateFile.length; i++) {\n          formData.append(\"certificate[]\", this.state.certificateFile[i]);\n        }\n\n        UserService.addBatch(formData).then(showResults(\"Data has been added\"));\n        this.wait(5000);\n        window.location.reload();\n      } else {\n        showResults(\"Please fill all the fields\");\n      }\n    };\n\n    this.handleIDBatch = () => {\n      var date = new Date().getDate();\n      var month = new Date().getMonth() + 1;\n      var year = new Date().getFullYear().toString().substr(-2);\n\n      if (date < 10) {\n        date = \"0\" + date;\n      }\n\n      if (month < 10) {\n        month = \"0\" + month;\n      }\n\n      let increment = 1;\n      let incrementalResultIDBatch = \"0\" + increment;\n      let resultIDBatch = \"\" + year + month + incrementalResultIDBatch;\n\n      for (let i = 0; i < this.state.content.length; i++) {\n        if (this.state.content[i].batch_id == resultIDBatch) {\n          increment += 1;\n\n          if (increment < 10) {\n            incrementalResultIDBatch = \"0\" + increment;\n          } else {\n            incrementalResultIDBatch = increment;\n          }\n\n          resultIDBatch = \"\" + year + month + incrementalResultIDBatch;\n        }\n      }\n\n      return resultIDBatch;\n    };\n\n    this.state = {\n      imageFile: \"\",\n      certificateFile: \"\",\n      content: []\n    };\n  }\n\n  componentDidMount() {\n    UserService.getListBatchAsc().then(response => {\n      this.setState({\n        content: response.data.batch\n      });\n    });\n  }\n\n  render() {\n    this.handleIDBatch();\n    return /*#__PURE__*/_jsxDEV(Fragment, {\n      children: /*#__PURE__*/_jsxDEV(DaftarBatchForm, {\n        onSubmit: this.handleSubmit,\n        onSelectImage: this.onFileChange,\n        onSelectCertificate: this.onCertificateChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Applications/MAMP/htdocs/blockchain_project/src/components/Grosir/Batch/DaftarBatch.js"],"names":["Fragment","Component","DaftarBatchForm","UserService","showResults","DaftarBatch","constructor","props","onFileChange","file","setState","imageFile","onCertificateChange","certificateFile","wait","ms","start","Date","getTime","end","handleSubmit","values","formData","FormData","batchID","handleIDBatch","batch_id","append","console","log","biji_id","undefined","jenis_id","proses_id","supplier_id","tgl_panen","volume","moisture","videoCulture","storytelling","state","i","length","addBatch","then","window","location","reload","date","getDate","month","getMonth","year","getFullYear","toString","substr","increment","incrementalResultIDBatch","resultIDBatch","content","componentDidMount","getListBatchAsc","response","data","batch","render"],"mappings":"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","sourcesContent":["import { Fragment, Component } from \"react\";\nimport DaftarBatchForm from \"./DaftarBatchForm\";\nimport UserService from \"../../../services/user.service\";\nimport showResults from \"../../showResults/showResults\";\n\nexport default class DaftarBatch extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      imageFile: \"\",\n      certificateFile: \"\",\n      content: [],\n    };\n  }\n\n  componentDidMount() {\n    UserService.getListBatchAsc().then((response) => {\n      this.setState({\n        content: response.data.batch,\n      });\n    });\n  }\n\n  onFileChange = (file) => {\n    this.setState({\n      imageFile: file,\n    });\n  };\n\n  onCertificateChange = (file) => {\n    this.setState({\n      certificateFile: file,\n    });\n  };\n\n  wait = (ms) => {\n    var start = new Date().getTime();\n    var end = start;\n    while(end < start + ms) {\n      end = new Date().getTime();\n   }\n }\n\n  handleSubmit = (values) => {\n    const formData = new FormData();\n    const batchID = this.handleIDBatch();\n\n    if(values.batch_id) {\n      formData.append(\"batch_id\", values.batch_id);\n      console.log('masuk value batch id');\n    } else {\n      formData.append(\"batch_id\", batchID);\n      console.log('masuk increment batch id');\n    }\n\n    if (\n      values.biji_id != undefined &&\n      values.jenis_id != undefined &&\n      // values.biji_id != undefined &&\n      // values.jenis_id != undefined &&\n      values.proses_id != undefined &&\n      values.supplier_id != undefined &&\n      values.tgl_panen != undefined &&\n      values.volume != undefined &&\n\n      //Form Baru\n      values.moisture != undefined &&\n      values.videoCulture != undefined &&\n      values.storytelling != undefined &&\n      \n      this.state.imageFile != \"\" &&\n      this.state.certificateFile != \"\"\n    ) {\n      \n      formData.append(\"biji_id\", values.biji_id);\n      formData.append(\"jenis_id\", values.jenis_id);\n      formData.append(\"proses_id\", values.proses_id);\n      formData.append(\"supplier_id\", values.supplier_id);\n      formData.append(\"tgl_panen\", values.tgl_panen);\n      formData.append(\"volume\", values.volume);\n\n      //Form Baru\n      formData.append(\"moisture\", values.moisture);\n      formData.append(\"video_culture\", values.videoCulture);\n      formData.append(\"storytelling\", values.storytelling);\n\n      for (let i = 0; i < this.state.imageFile.length; i++) {\n        formData.append(\"files[]\", this.state.imageFile[i]);\n      }\n\n      for (let i = 0; i < this.state.certificateFile.length; i++) {\n        formData.append(\"certificate[]\", this.state.certificateFile[i]);\n      }\n\n      UserService.addBatch(formData).then(\n        showResults(\"Data has been added\")\n      );\n\n      this.wait(5000);\n      window.location.reload();\n    } else {\n      showResults(\"Please fill all the fields\");\n    }\n  };\n\n  handleIDBatch = () => {\n    var date = new Date().getDate();\n    var month = new Date().getMonth() + 1;\n    var year = new Date().getFullYear().toString().substr(-2);\n\n    if (date < 10) {\n      date = \"0\" + date;\n    }\n    if (month < 10) {\n      month = \"0\" + month;\n    }\n\n    let increment = 1;\n    let incrementalResultIDBatch = \"0\" + increment;\n    let resultIDBatch = \"\" + year + month + incrementalResultIDBatch;\n\n    for (let i = 0; i < this.state.content.length; i++) {\n      if (this.state.content[i].batch_id == resultIDBatch) {\n        increment += 1;\n        if (increment < 10) {\n          incrementalResultIDBatch = \"0\" + increment;\n        }\n        else {\n          incrementalResultIDBatch = increment;\n        }\n        resultIDBatch = \"\" + year + month + incrementalResultIDBatch;\n      }\n    }\n\n    return resultIDBatch;\n  };\n\n  render() {\n    this.handleIDBatch();\n    return (\n      <Fragment>\n        <DaftarBatchForm\n          onSubmit={this.handleSubmit}\n          onSelectImage={this.onFileChange}\n          onSelectCertificate={this.onCertificateChange}\n        />\n      </Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}