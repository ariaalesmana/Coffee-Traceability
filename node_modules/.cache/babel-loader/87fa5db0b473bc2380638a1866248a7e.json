{"ast":null,"code":"var _jsxFileName = \"/Applications/MAMP/htdocs/blockchain_project/src/components/Grosir/Batch/DaftarBatch.js\";\nimport { Fragment, Component } from \"react\";\nimport DaftarBatchForm from \"./DaftarBatchForm\";\nimport UserService from \"../../../services/user.service\";\nimport showResults from \"../../showResults/showResults\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class DaftarBatch extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onFileChange = file => {\n      this.setState({\n        imageFile: file\n      });\n    };\n\n    this.onCertificateChange = file => {\n      this.setState({\n        certificateFile: file\n      });\n    };\n\n    this.wait = ms => {\n      var start = new Date().getTime();\n      var end = start;\n\n      while (end < start + ms) {\n        end = new Date().getTime();\n      }\n    };\n\n    this.handleSubmit = values => {\n      const formData = new FormData();\n      UserService.getListBatchAsc().then(response => {\n        this.setState({\n          content: response.data.batch\n        });\n      });\n      this.wait(5000);\n      const batchID = this.handleIDBatch();\n      formData.append(\"batch_id\", batchID);\n\n      if (values.biji_id != undefined && values.jenis_id != undefined && values.biji_id != undefined && values.jenis_id != undefined && values.proses_id != undefined && values.supplier_id != undefined && values.tgl_panen != undefined && values.volume != undefined && //Form Baru\n      values.moisture != undefined && values.videoCulture != undefined && values.storytelling != undefined && this.state.imageFile != \"\" && this.state.certificateFile != \"\") {\n        formData.append(\"biji_id\", values.biji_id);\n        formData.append(\"jenis_id\", values.jenis_id);\n        formData.append(\"proses_id\", values.proses_id);\n        formData.append(\"supplier_id\", values.supplier_id);\n        formData.append(\"tgl_panen\", values.tgl_panen);\n        formData.append(\"volume\", values.volume); //Form Baru\n\n        formData.append(\"moisture\", values.moisture);\n        formData.append(\"video_culture\", values.videoCulture);\n        formData.append(\"storytelling\", values.storytelling);\n\n        for (let i = 0; i < this.state.imageFile.length; i++) {\n          formData.append(\"files[]\", this.state.imageFile[i]);\n        }\n\n        for (let i = 0; i < this.state.certificateFile.length; i++) {\n          formData.append(\"certificate[]\", this.state.certificateFile[i]);\n        }\n\n        UserService.addBatch(formData).then(showResults(\"Data has been added\"));\n      } else {\n        showResults(\"Please fill all the fields\");\n      }\n    };\n\n    this.handleIDBatch = () => {\n      var date = new Date().getDate();\n      var month = new Date().getMonth() + 1;\n      var year = new Date().getFullYear().toString().substr(-2);\n\n      if (date < 10) {\n        date = \"0\" + date;\n      }\n\n      if (month < 10) {\n        month = \"0\" + month;\n      }\n\n      let increment = 1;\n      let incrementalResultIDBatch = \"0\" + increment;\n      let resultIDBatch = \"\" + year + month + // date + \n      incrementalResultIDBatch;\n\n      for (let i = this.state.content.length - 1; i >= 0; i--) {\n        if (this.state.content[i].batch_id === resultIDBatch) {\n          increment += 1;\n        }\n\n        if (increment < 10) {\n          incrementalResultIDBatch = \"0\" + increment;\n        } else {\n          incrementalResultIDBatch = increment;\n        }\n\n        resultIDBatch = \"\" + year + month + // date + \n        incrementalResultIDBatch;\n      }\n\n      return resultIDBatch;\n    };\n\n    this.state = {\n      imageFile: \"\",\n      certificateFile: \"\",\n      content: []\n    };\n  }\n\n  componentDidMount() {\n    UserService.getListBatchAsc().then(response => {\n      this.setState({\n        content: response.data.batch\n      });\n    });\n  }\n\n  render() {\n    this.handleIDBatch();\n    return /*#__PURE__*/_jsxDEV(Fragment, {\n      children: /*#__PURE__*/_jsxDEV(DaftarBatchForm, {\n        onSubmit: this.handleSubmit,\n        onSelectImage: this.onFileChange,\n        onSelectCertificate: this.onCertificateChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Applications/MAMP/htdocs/blockchain_project/src/components/Grosir/Batch/DaftarBatch.js"],"names":["Fragment","Component","DaftarBatchForm","UserService","showResults","DaftarBatch","constructor","props","onFileChange","file","setState","imageFile","onCertificateChange","certificateFile","wait","ms","start","Date","getTime","end","handleSubmit","values","formData","FormData","getListBatchAsc","then","response","content","data","batch","batchID","handleIDBatch","append","biji_id","undefined","jenis_id","proses_id","supplier_id","tgl_panen","volume","moisture","videoCulture","storytelling","state","i","length","addBatch","date","getDate","month","getMonth","year","getFullYear","toString","substr","increment","incrementalResultIDBatch","resultIDBatch","batch_id","componentDidMount","render"],"mappings":"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","sourcesContent":["import { Fragment, Component } from \"react\";\nimport DaftarBatchForm from \"./DaftarBatchForm\";\nimport UserService from \"../../../services/user.service\";\nimport showResults from \"../../showResults/showResults\";\n\nexport default class DaftarBatch extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      imageFile: \"\",\n      certificateFile: \"\",\n      content: [],\n    };\n  }\n\n  componentDidMount() {\n    UserService.getListBatchAsc().then((response) => {\n      this.setState({\n        content: response.data.batch,\n      });\n    });\n  }\n\n  onFileChange = (file) => {\n    this.setState({\n      imageFile: file,\n    });\n  };\n\n  onCertificateChange = (file) => {\n    this.setState({\n      certificateFile: file,\n    });\n  };\n\n  wait = (ms) => {\n    var start = new Date().getTime();\n    var end = start;\n    while(end < start + ms) {\n      end = new Date().getTime();\n   }\n }\n  \n\n  handleSubmit = (values) => {\n    const formData = new FormData();\n    UserService.getListBatchAsc().then((response) => {\n      this.setState({\n        content: response.data.batch,\n      });\n    });\n    this.wait(5000); \n    const batchID = this.handleIDBatch();\n    formData.append(\"batch_id\", batchID);\n\n    if (\n      values.biji_id != undefined &&\n      values.jenis_id != undefined &&\n      values.biji_id != undefined &&\n      values.jenis_id != undefined &&\n      values.proses_id != undefined &&\n      values.supplier_id != undefined &&\n      values.tgl_panen != undefined &&\n      values.volume != undefined &&\n\n      //Form Baru\n      values.moisture != undefined &&\n      values.videoCulture != undefined &&\n      values.storytelling != undefined &&\n      \n      this.state.imageFile != \"\" &&\n      this.state.certificateFile != \"\"\n    ) {\n      formData.append(\"biji_id\", values.biji_id);\n      formData.append(\"jenis_id\", values.jenis_id);\n      formData.append(\"proses_id\", values.proses_id);\n      formData.append(\"supplier_id\", values.supplier_id);\n      formData.append(\"tgl_panen\", values.tgl_panen);\n      formData.append(\"volume\", values.volume);\n\n      //Form Baru\n      formData.append(\"moisture\", values.moisture);\n      formData.append(\"video_culture\", values.videoCulture);\n      formData.append(\"storytelling\", values.storytelling);\n\n      for (let i = 0; i < this.state.imageFile.length; i++) {\n        formData.append(\"files[]\", this.state.imageFile[i]);\n      }\n\n      for (let i = 0; i < this.state.certificateFile.length; i++) {\n        formData.append(\"certificate[]\", this.state.certificateFile[i]);\n      }\n\n      UserService.addBatch(formData).then(showResults(\"Data has been added\"));\n    } else {\n      showResults(\"Please fill all the fields\");\n    }\n  };\n\n  handleIDBatch = () => {\n    var date = new Date().getDate();\n    var month = new Date().getMonth() + 1;\n    var year = new Date().getFullYear().toString().substr(-2);\n\n    if (date < 10) {\n      date = \"0\" + date;\n    }\n    if (month < 10) {\n      month = \"0\" + month;\n    }\n\n    let increment = 1;\n    let incrementalResultIDBatch = \"0\" + increment;\n    let resultIDBatch = \"\" + year + month + \n    // date + \n    incrementalResultIDBatch;\n\n    for (let i = this.state.content.length - 1; i >= 0; i--) {\n      if (this.state.content[i].batch_id === resultIDBatch) {\n        increment += 1;\n      }\n      if (increment < 10) {\n        incrementalResultIDBatch = \"0\" + increment;\n      }\n      else {\n        incrementalResultIDBatch = increment;\n      }\n      resultIDBatch = \"\" + year + month + \n      // date + \n      incrementalResultIDBatch;\n    }\n\n    return resultIDBatch;\n  };\n\n  render() {\n    this.handleIDBatch();\n    return (\n      <Fragment>\n        <DaftarBatchForm\n          onSubmit={this.handleSubmit}\n          onSelectImage={this.onFileChange}\n          onSelectCertificate={this.onCertificateChange}\n        />\n      </Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}